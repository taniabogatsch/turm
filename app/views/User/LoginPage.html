<!-- the login page provides the login form -->

<!-- set title and header -->
{{set . "title" .tabName}}
{{template "header.html" .}}

<div class="page page-side page-side-left">
  <br class="mobile-hidden">
</div>

<div class="page page-middle">
  <center>
    <h3>
      {{msg $ "login.pageName"}}
    </h3>
    <br>

    <div style="width:50%">
      <ul class="nav nav-tabs" id="loginType" role="tablist" >
        <li class="nav-item" style="width:50%;">
          <a class="nav-link active" id="ldap" data-toggle="tab" href="#loginForm" role="tab" aria-selected="true">
            {{msg $ "user.ldap"}}
          </a>
        </li>
        <li class="nav-item" style="width:50%;">
          <a class="nav-link" id="external" data-toggle="tab" href="#loginForm" role="tab" aria-selected="false">
            {{msg $ "user.external"}}
          </a>
        </li>
      </ul>
      <div class="tab-content" id="loginTypeContent" style="width:65%;">
        <div class="tab-pane fade show active" id="loginForm" role="tabpanel">

          <br>
          <br>

          <!-- login form -->
          <form accept-charset="UTF-8" action='{{url "User.Login"}}' method="POST" class="needs-validation" novalidate>
            <!-- username or e-mail input -->
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="input-icon">
                  {{template "Icons/Person.html" .}}
                </span>
              </div>
              <input id="input-user" type="text" class="form-control" name="credentials.Username" value="" placeholder='{{msg $ "user.username"}}' required maxlength="255">
              <div class="invalid-feedback" id="input-user-validation">
                {{msg $ "validation.invalid.username"}}
              </div>
            </div>
            <!-- password input -->
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  {{template "Icons/Lock.html" .}}
                </span>
              </div>
              <input type="password" class="form-control" name="credentials.Password" value="" placeholder='{{msg $ "user.password"}}' required maxlength="511">
              <div class="invalid-feedback">
                {{msg $ "validation.missing.password"}}
              </div>
            </div>
            <!-- keep logged in input -->
            <div class="form-group">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" name="credentials.StayLoggedIn" value="true" checked>
                <label class="form-check-label">
                  {{msg $ "login.stayLoggedIn"}}
                </label>
              </div>
            </div>
            <!-- button to confirm login -->
            <button class="btn btn-darkblue" type="submit">
              {{msg $ "login.pageName"}}
            </button>
          </form>

        </div>
      </div>

      <!-- link to register page -->
      <br>
      <br>
      <a href='#'> <!-- TODO -->
        {{msg $ "register.pageName"}}
      </a>

      <!-- link to new password page -->
      <br>
      <br>
      <a href='#'> <!-- TODO -->
        {{msg $ "newPw.pwforgottenQuestion"}}
      </a>

    </div>
  </center>
</div>

<div class="page page-side page-side-right">
  <br class="mobile-hidden">
</div>

<div id="icon-person" class="display-none"> {{template "Icons/Person.html" .}} </div>
<div id="icon-email" class="display-none"> {{template "Icons/Envelope.html" .}} </div>

<script>
  //adjust input fields when switching tabs
  $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
    if ($(e.target).attr('id') == "ldap") {
      $("#input-icon").html($("#icon-person").html());
      $("#input-user").attr("name", "credentials.Username");
      $("#input-user").attr("placeholder", '{{msg $ "user.username"}}');
      $("#input-user").attr("type", "text");
      $("#input-user-validation").html('{{msg $ "validation.invalid.username"}}');
    } else {
      $("#input-icon").html($("#icon-email").html());
      $("#input-user").attr("name", "credentials.EMail");
      $("#input-user").attr("placeholder", '{{msg $ "user.email"}}');
      $("#input-user").attr("type", "email");
      $("#input-user-validation").html('{{msg $ "validation.invalid.email"}}');
    }
  });
</script>

{{template "footer.html" .}}
