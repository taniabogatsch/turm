<!-- course shows all course information -->

<!-- general course information -->
<table class="table table-borderless">

  <!-- title -->
  <tr>
    <td colspan="2">
      <h4>
        {{.course.Title}}
        <a href="#" class="badge btn-outline-darkblue preview-hide"
          onclick='changeTextModal({{msg $ "course.title"}}, {{url "EditCourse.ChangeTitle"}}, "title",
            {{.course.Title}}, "511", {{msg $ "validation.invalid.title"}});'>
          {{template "icons/pencil.html" . }}
        </a>
      </h4>
    </td>
  </tr>

  <!-- subtitle -->
  {{if .course.Subtitle.Valid}}
    <tr>
      <td colspan="2">
        <h5>
          {{.course.Subtitle.String}}
          <a href="#" class="badge btn-outline-darkblue preview-hide"
            onclick='changeTextModal({{msg $ "course.subtitle"}}, {{url "EditCourse.ChangeSubtitle"}}, "subtitle",
              {{.course.Subtitle.String}}, "511", {{msg $ "validation.invalid.subtitle"}});'>
            {{template "icons/pencil.html" . }}
          </a>
          <a href="#" class="badge btn-outline-darkblue preview-hide"
            onclick='openDeleteField({{msg $ "course.subtitle.delete.title"}}, {{msg $ "course.subtitle.delete.confirm" .course.Subtitle.String}},
              {{url "EditCourse.ChangeSubtitle" .course.ID}});'>
            {{template "icons/trash.html" . }}
          </a>
        </h5>
      </td>
    </tr>
  {{else}}
    <tr class="preview-hide">
      <td colspan="2">
        <button type="button" class="btn btn-outline-darkblue"
          onclick='changeTextModal({{msg $ "course.subtitle"}}, {{url "EditCourse.ChangeSubtitle"}}, "subtitle",
            {{.course.Subtitle.String}}, "511", {{msg $ "validation.invalid.subtitle"}});'>
          {{msg $ "creator.add.subtitle"}}
        </button>
      </td>
    </tr>
  {{end}}

  <!-- course creator -->
  <tr>
    <td class="text-muted">
      {{msg $ "user.role.creator"}}:
    </td>
    <td>
      {{template "templates/salutation.html" dict_addLocale $.currentLocale "User" .course.CreatorData}} |
      <a href="mailto:{{.course.CreatorData.EMail}}" target="_top">
        {{template "icons/envelope.html" .}}
        {{.course.CreatorData.EMail}}
      </a>
    </td>
  </tr>

  <!-- course editors and instructors -->
  {{if or .course.Editors .course.Instructors}}
    <tr>
      <td class="text-muted">
        {{msg $ "user.role.instructors"}}:
      </td>
      <td>
        {{range $key, $user := .course.Editors}}
          {{if ne $key 0}}<br>{{end}}
          {{template "templates/salutation.html" dict_addLocale $.currentLocale "User" $user}} |
          <a href="mailto:{{.EMail}}" target="_top">
            {{template "icons/envelope.html" .}}
            {{.EMail}}
          </a>
          <div class="preview-hide text-muted">
            {{msg $ "user.role.editor"}}
            |
            {{if .ViewMatrNr}}{{template "icons/eye.html" . }}{{msg $ "user.matr.nrs"}}{{else}}{{template "icons/eyeSlash.html" . }}{{msg $ "user.matr.nrs"}}{{end}}
            <a href="#" class="badge btn-outline-darkblue"
              onclick='openBoolModal({{msg $ "course.matr.nr.change.title"}}, {{url "EditCourse.ChangeViewMatrNr"}}, {{msg $ "course.see.matr.nr.info"}},
                {{msg $ "course.not.see.matr.nr.info"}}, {{.ViewMatrNr}}, {{.UserID}}, "editor");'>
              {{template "icons/pencil.html" . }}
            </a>
            |
            <a href="#" class="badge btn-outline-darkblue"
              onclick='openDeleteField({{msg $ "course.editor.delete.title"}}, {{msg $ "course.editor.delete.confirm" .EMail}},
                {{url "EditCourse.DeleteFromUserList" .CourseID .UserID "editor"}});'>
              {{template "icons/trash.html" . }}
            </a>
          </div>
        {{end}}
        {{range $key, $user := .course.Instructors}}
          {{if $.course.Editors}}<br>{{else if ne $key 0}}<br>{{end}}
          {{template "templates/salutation.html" dict_addLocale $.currentLocale "User" $user}} |
          <a href="mailto:{{.EMail}}" target="_top">
            {{template "icons/envelope.html" .}}
            {{.EMail}}
          </a>
          <div class="preview-hide text-muted">
            {{msg $ "user.role.instructor"}}
            |
            {{if .ViewMatrNr}}{{template "icons/eye.html" . }}{{msg $ "user.matr.nrs"}}{{else}}{{template "icons/eyeSlash.html" . }}{{msg $ "user.matr.nrs"}}{{end}}
            <a href="#" class="badge btn-outline-darkblue"
              onclick='openBoolModal({{msg $ "course.matr.nr.change.title"}}, {{url "EditCourse.ChangeViewMatrNr"}}, {{msg $ "course.see.matr.nr.info"}},
                {{msg $ "course.not.see.matr.nr.info"}}, {{.ViewMatrNr}}, {{.UserID}}, "instructor");'>
              {{template "icons/pencil.html" . }}
            </a>
            |
            <a href="#" class="badge btn-outline-darkblue"
              onclick='openDeleteField({{msg $ "course.instructor.delete.title"}}, {{msg $ "course.instructor.delete.confirm" .EMail}},
                {{url "EditCourse.DeleteFromUserList" .CourseID .UserID "instructor"}});'>
              {{template "icons/trash.html" . }}
            </a>
          </div>
        {{end}}
      </td>
    </tr>
  {{end}}
  <tr class="preview-hide">
    <td></td>
    <td>
      <button type="button" class="btn btn-outline-darkblue"
        onclick='changeUserListModal({{msg $ "creator.add.editor"}}, "editor");'>
        {{msg $ "creator.add.editor"}}
      </button>
      <button type="button" class="btn btn-outline-darkblue"
        onclick='changeUserListModal({{msg $ "creator.add.instructor"}}, "instructor");'>
        {{msg $ "creator.add.instructor"}}
      </button>
    </td>
  </tr>

  <!-- registration period -->
  <tr>
    <td class="text-muted">
      {{msg $ "course.enrollment.period"}}:
    </td>
    <td>
      {{msg $ "course.from"}} {{.course.EnrollmentStart}} {{msg $ "course.clock"}}
      <a href="#" class="badge btn-outline-darkblue preview-hide"
        onclick='openTimestampModal({{msg $ "course.enrollment.start"}}, "",
          "enrollmentstart", {{.course.EnrollmentStart}});'>
        {{template "icons/pencil.html" . }}
      </a>
      <br>
      {{msg $ "course.to"}} {{.course.EnrollmentEnd}} {{msg $ "course.clock"}}
      <a href="#" class="badge btn-outline-darkblue preview-hide"
        onclick='openTimestampModal({{msg $ "course.enrollment.end"}}, "",
          "enrollmentend", {{.course.EnrollmentEnd}});'>
        {{template "icons/pencil.html" . }}
      </a>
    </td>
  </tr>

  <!-- if the course has a time up to which users can unsubscribe -->
  {{if .course.UnsubscribeEnd.Valid}}
    <tr>
      <td class="text-muted">
        {{msg $ "course.unsubscribe.end"}}:
      </td>
      <td>
        {{.course.UnsubscribeEnd.String}} {{msg $ "course.clock"}}
        <a href="#" class="badge btn-outline-darkblue preview-hide"
          onclick='openTimestampModal({{msg $ "course.unsubscribe.end"}}, {{msg $ "course.unsubscribe.end.info"}},
            "unsubscribeend", {{.course.UnsubscribeEnd.String}});'>
          {{template "icons/pencil.html" . }}
        </a>
        <a href="#" class="badge btn-outline-darkblue preview-hide"
          onclick='openDeleteField({{msg $ "course.unsubscribe.end.delete.title"}},
            {{msg $ "course.unsubscribe.end.delete.confirm" .course.UnsubscribeEnd.String}},
            {{url "EditCourse.ChangeTimestamp" .course.ID "" "" "unsubscribeend"}});'>
          {{template "icons/trash.html" . }}
        </a>
      </td>
    </tr>
  {{else}}
    <tr class="preview-hide">
      <td></td>
      <td>
        <button type="button" class="btn btn-outline-darkblue"
          onclick='openTimestampModal({{msg $ "course.unsubscribe.end"}}, {{msg $ "course.unsubscribe.end.info"}},
            "unsubscribeend", {{.course.UnsubscribeEnd.String}});'>
          {{msg $ "creator.add.unsubscribe.end"}}
        </button>
      </td>
    </tr>
  {{end}}

  <!-- show fee if there is one -->
  {{if .course.Fee.Valid}}
    <tr>
       <td class="text-muted">
         {{msg $ "course.fee"}}:
       </td>
       <td>
         {{.course.Fee.Float64}}â‚¬
         <a href="#" class="badge btn-outline-darkblue preview-hide" data-toggle="modal" data-target="#change-fee-modal">
           {{template "icons/pencil.html" . }} <!-- TODO -->
         </a>
         <a href='#' class="badge btn-outline-darkblue preview-hide">
           {{template "icons/trash.html" . }} <!-- TODO -->
         </a>
       </td>
    </tr>
  {{else}}
    <tr class="preview-hide">
      <td></td>
      <td>
        <!-- TODO -->
        <button type="button" class="btn btn-outline-darkblue" data-toggle="modal" data-target="#change-fee-modal">
          {{msg $ "creator.add.fee"}}
        </button>
      </td>
    </tr>
  {{end}}

  {{if .course.Description.Valid}}
    <tr>
      <td class="text-muted">
        {{msg $ "course.description"}}
        <br>
        <a class="" data-toggle="collapse" href="#course-description" role="button"
          aria-expanded="true" aria-controls="course-description">
          {{msg $ "button.collapse"}} <!-- TODO: change content upon collapse/show -->
        </a>
      </td>
      <td>
        <div class="collapse show" id="course-description">
          <!-- TODO -->
        </div>
      </td>
    </tr>
  {{else}}
    <tr class="preview-hide">
      <td></td>
      <td>
        <!-- TODO -->
        <button type="button" class="btn btn-outline-darkblue"
          onclick='openTextAreaModal({{msg $ "course.description"}});'>
          {{msg $ "creator.add.description"}}
        </button>
      </td>
    </tr>
  {{end}}

  <!-- more settings -->
  <tr class="preview-hide">
    <td colspan="2">
      <h5>
        <br>
        <br>
        {{template "icons/tools.html" .}}
        &nbsp; {{msg $ "creator.more.settings"}}
      </h5>
      <small class="text-muted">
        {{msg $ "creator.more.settings.info"}}
      </small>
    </td>
  </tr>

  <!-- course path -->
  <tr class="preview-hide">
    <td class="text-muted">
      {{msg $ "course.path"}}
    </td>
    <td>
      {{if .course.Path}}
        <ol class="breadcrumb bg-white m-0 p-0">
          {{range .course.Path}}
            <li class="breadcrumb-item">{{.Name}}</li>
            {{if eq .Name $.course.Title}}
              &nbsp;
              <a href="#" class="badge btn-outline-darkblue float-right"
                data-toggle="modal" data-target="#change-group-modal">
                {{template "icons/pencil.html" . }}
              </a>
            {{end}}
          {{end}}
        </ol>
      {{else}}
        <button type="button" class="btn btn-outline-darkblue"
          data-toggle="modal" data-target="#change-group-modal">
          {{msg $ "creator.add.path"}}
        </button>
      {{end}}
    </td>
  </tr>

  <!-- visibility -->
  <tr class="preview-hide">
    <td class="text-muted">
      {{msg $ "course.visibility"}}:
    </td>
    <td>
      {{if .course.Visible}}
        {{msg $ "course.visibility.public"}}
      {{else}}
        {{msg $ "course.visibility.not.public"}}
      {{end}}
      <a href="#" class="badge btn-outline-darkblue"
        onclick='openBoolModal({{msg $ "course.visibility.change.title"}}, {{url "EditCourse.ChangeVisibility"}}, {{msg $ "course.visibility.public"}},
          {{msg $ "course.visibility.not.public"}}, {{.course.Visible}}, "", "");'>
        {{template "icons/pencil.html" . }}
      </a>
    </td>
  </tr>

  <!-- expiration date -->
  <tr class="preview-hide">
    <td class="text-muted">
      {{msg $ "course.expiration.date"}}:
    </td>
    <td>
      {{.course.ExpirationDate}} {{msg $ "course.clock"}}
      <a href="#" class="badge btn-outline-darkblue preview-hide"
        onclick='openTimestampModal({{msg $ "course.expiration.date"}}, {{msg $ "course.expiration.date.info"}},
          "expirationdate", {{.course.ExpirationDate}});'>
        {{template "icons/pencil.html" . }}
      </a>
    </td>
  </tr>

  <!-- TODO: custom e-mail -->
  <tr class="preview-hide">
    <td class="text-muted">
      Willkommensemail:
    </td>
    <td>
    </td>
  </tr>

  <!-- TODO: enrollment limit events -->
  <tr class="preview-hide">
    <td class="text-muted">
      Einschreibelimit:
    </td>
    <td>
    </td>
  </tr>

  <!-- whitelist -->
  {{if .course.Whitelist}}
    <tr class="preview-hide">
      <td class="text-muted">
        {{msg $ "course.whitelist"}}:
      </td>
      <td>
        {{range $key, $user := .course.Whitelist}}
          {{if ne $key 0}}<br>{{end}}
          {{template "templates/salutation.html" dict_addLocale $.currentLocale "User" $user}} |
          <a href="mailto:{{.EMail}}" target="_top">
            {{template "icons/envelope.html" .}}
            {{.EMail}}
          </a>
          |
          <a href="#" class="badge btn-outline-darkblue"
            onclick='openDeleteField({{msg $ "course.whitelist.delete.title"}}, {{msg $ "course.whitelist.delete.confirm" .EMail}},
              {{url "EditCourse.DeleteFromUserList" .CourseID .UserID "whitelist"}});'>
            {{template "icons/trash.html" . }}
          </a>
        {{end}}
      </td>
    </tr>
  {{end}}
  <tr class="preview-hide">
    <td></td>
    <td>
      <button type="button" class="btn btn-outline-darkblue"
        onclick='changeUserListModal({{msg $ "creator.add.whitelist"}}, "whitelist");'>
        {{msg $ "creator.add.whitelist"}}
      </button>
    </td>
  </tr>

  <!-- blacklist -->
  {{if .course.Blacklist}}
    <tr class="preview-hide">
      <td class="text-muted">
        {{msg $ "course.blacklist"}}:
      </td>
      <td>
        {{range $key, $user := .course.Blacklist}}
          {{if ne $key 0}}<br>{{end}}
          {{template "templates/salutation.html" dict_addLocale $.currentLocale "User" $user}} |
          <a href="mailto:{{.EMail}}" target="_top">
            {{template "icons/envelope.html" .}}
            {{.EMail}}
          </a>
          |
          <a href="#" class="badge btn-outline-darkblue"
            onclick='openDeleteField({{msg $ "course.blacklist.delete.title"}}, {{msg $ "course.blacklist.delete.confirm" .EMail}},
              {{url "EditCourse.DeleteFromUserList" .CourseID .UserID "blacklist"}});'>
            {{template "icons/trash.html" . }}
          </a>
        {{end}}
      </td>
    </tr>
  {{end}}
  <tr class="preview-hide">
    <td></td>
    <td>
      <button type="button" class="btn btn-outline-darkblue"
        onclick='changeUserListModal({{msg $ "creator.add.blacklist"}}, "blacklist");'>
        {{msg $ "creator.add.blacklist"}}
      </button>
    </td>
  </tr>
</table>

<script>
  function showPreview() {
    $(".preview-hide").each(function() {
      $(this).addClass("display-none");
    });
    $('#preview-btn').attr("onclick", "hidePreview();");
    $('#preview-btn').html("Edit");
  }
  function hidePreview() {
    $(".preview-hide").each(function() {
      $(this).removeClass("display-none");
    });
    $('#preview-btn').attr("onclick", "showPreview();");
    $('#preview-btn').html("Preview");
  }
</script>
